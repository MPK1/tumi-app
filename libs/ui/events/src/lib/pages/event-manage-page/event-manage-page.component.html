<main *ngIf="event$ | async as event" class="p-4">
  <h1>Manage {{ event.title }}</h1>
  <div class="border p-4 rounded-2xl my-4">
    <h2>Finances</h2>
    <div>
      {{ (event?.amountCollected ?? 0) / 100 | currency: 'EUR' }}-{{
        (event?.feesPaid ?? 0) / 100 | currency: 'EUR'
      }}={{ (event?.netAmountCollected ?? 0) / 100 | currency: 'EUR' }}
    </div>
    <tumi-manage-event-finances
      [eventId]="event.id"
    ></tumi-manage-event-finances>
  </div>
  <div class="border p-4 rounded-2xl my-4">
    <h2 class="mb-4">Participants</h2>
    <div fxLayout="column" fxLayoutGap="1rem">
      <div
        *ngFor="let registration of event.participantRegistrations"
        class="border-t"
        fxLayout="row"
        fxLayoutGap="1rem"
      >
        <img
          [src]="registration.user.picture"
          class="h-12 rounded"
          referrerpolicy="no-referrer"
        />
        <div>
          <p>{{ registration.user.fullName }}</p>
          <p>{{ registration.user.email }}</p>
          <p>
            Paid:
            <span class="px-1 rounded bg-gray-200 font-mono mr-2">
              {{ (registration.netPaid ?? 0) / 100 | currency: 'EUR' }}
            </span>
            Registered:
            <span class="px-1 rounded bg-gray-200 font-mono">
              {{ registration.createdAt | date: 'medium' }}
            </span>
          </p>
        </div>
        <div>
          <p>During event</p>
          <p>
            Checked in:
            <span class="px-1 rounded bg-gray-200 font-mono">
              {{ registration.checkInTime | date: 'medium' }}
            </span>
          </p>
        </div>
        <div>
          <button
            mat-flat-button
            (click)="kickWithRefund(registration.user.id)"
            [disabled]="
              (registration.netPaid ?? 0) === 0 || registration.checkInTime
            "
          >
            Kick with refund
          </button>
          <button
            mat-flat-button
            (click)="kick(registration.user.id)"
            [disabled]="registration.checkInTime"
            color="{{ (registration.netPaid ?? 0) === 0 ? '' : 'warn' }}"
          >
            Kick without refund
          </button>
        </div>
      </div>
    </div>
  </div>
</main>
