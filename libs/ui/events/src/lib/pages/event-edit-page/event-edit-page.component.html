<main class="p-4">
  <div fxLayout="row" fxLayoutAlign="start center">
    <a routerLink=".." mat-icon-button>
      <mat-icon svgIcon="icon-circled-chevron-left"></mat-icon>
    </a>
    <h1>Edit event</h1>
  </div>
  <div class="my-8 py-4">
    <h2 class="mb-2">General information</h2>
    <form [formGroup]="generalInformationForm" (ngSubmit)="onSubmit()">
      <mat-form-field class="w-full">
        <mat-label>Event Title</mat-label>
        <input matInput formControlName="title" type="text" />
      </mat-form-field>
      <mat-form-field class="w-full">
        <mat-label>Event Icon</mat-label>
        <input matInput formControlName="icon" type="text" />
        <img
          [src]="iconValue | iconURL"
          alt="icon"
          matSuffix
          width="24px"
          height="24px"
        />
      </mat-form-field>
      <div fxLayout.gt-sm="row" fxLayout="column" fxLayoutGap="1rem">
        <mat-form-field class="w-full">
          <mat-label>Event Start</mat-label>
          <input matInput formControlName="start" type="datetime-local" />
        </mat-form-field>
        <mat-form-field class="w-full">
          <mat-label>Event End</mat-label>
          <input matInput formControlName="end" type="datetime-local" />
        </mat-form-field>
      </div>
      <mat-form-field class="w-full">
        <mat-label>Event Description</mat-label>
        <textarea matInput formControlName="description" rows="10"></textarea>
      </mat-form-field>
      <mat-form-field class="w-full">
        <mat-label>Organizer Help</mat-label>
        <textarea matInput formControlName="organizerText" rows="10"></textarea>
      </mat-form-field>
      <div fxLayout.gt-sm="row" fxLayout="column" fxLayoutGap="1rem">
        <mat-form-field class="w-full">
          <mat-label>Organizing Institution</mat-label>
          <mat-select formControlName="eventOrganizerId">
            <mat-option
              *ngFor="let organizer of organizers$ | async"
              [value]="organizer.id"
              >{{ organizer.name }}</mat-option
            >
          </mat-select>
        </mat-form-field>
        <mat-form-field class="w-full">
          <mat-label>Registration Mode</mat-label>
          <mat-select formControlName="registrationMode" required>
            <mat-option [value]="RegistrationMode.External">{{
              RegistrationMode.External | titlecase
            }}</mat-option>
            <mat-option [value]="RegistrationMode.Stripe">{{
              RegistrationMode.Stripe | titlecase
            }}</mat-option>
            <mat-option [value]="RegistrationMode.Online">{{
              RegistrationMode.Online | titlecase
            }}</mat-option>
          </mat-select>
          <mat-hint>Select how users will register for this event</mat-hint>
        </mat-form-field>
      </div>
      <div fxLayout.gt-sm="row" fxLayout="column" fxLayoutGap="1rem">
        <mat-form-field class="w-full">
          <mat-label>Price</mat-label>
          <input matInput formControlName="price" type="number" required />
          <span matSuffix>â‚¬</span>
          <mat-hint>The price users have to pay for this event</mat-hint>
          <mat-error>
            You have to specify a price or change the registration type
          </mat-error>
        </mat-form-field>
        <mat-form-field class="w-full">
          <mat-label>Registration link</mat-label>
          <input
            matInput
            formControlName="registrationLink"
            type="url"
            required
          />
          <mat-hint>The link where users can register for this event</mat-hint>
          <mat-error>
            You have to specify a link or change the registration type
          </mat-error>
        </mat-form-field>
      </div>
      <div fxLayout.gt-sm="row" fxLayout="column" fxLayoutGap="1rem">
        <mat-form-field class="w-full">
          <mat-label>Number of organizers</mat-label>
          <input
            matInput
            formControlName="organizerLimit"
            type="number"
            required
          />
          <mat-hint>Maximum number of students that can sign up</mat-hint>
          <mat-error>
            You have to set the maximum number of participants
          </mat-error>
        </mat-form-field>
        <mat-form-field class="w-full">
          <mat-label>Number of participants</mat-label>
          <input
            matInput
            formControlName="participantLimit"
            type="number"
            required
          />
          <mat-hint>Maximum number of organizers that can sign up</mat-hint>
          <mat-error>
            You have to set the maximum number of organizers
          </mat-error>
        </mat-form-field>
      </div>
      <div class="mt-4">
        <button type="submit" mat-flat-button color="primary">
          Save Changes
        </button>
      </div>
    </form>
  </div>
  <div class="my-8 py-4">
    <div fxLayoutGap="1rem" fxLayout="row" fxLayoutAlign="start center">
      <h2 class="mb-2">Assigned Organizers</h2>
      <button mat-icon-button>
        <mat-icon svgIcon="icon-add" (click)="addOrganizer()"></mat-icon>
      </button>
    </div>

    <mat-list class="max-w-lg">
      <mat-list-item *ngFor="let user of (event$ | async)?.organizers">
        <img [src]="user.picture" alt="Image" mat-list-avatar />
        <p mat-line>{{ user.fullName }}</p>
        <button mat-icon-button (click)="removeUser(user.id)">
          <mat-icon svgIcon="icon-delete-sign"></mat-icon>
        </button>
      </mat-list-item>
    </mat-list>
  </div>
</main>
