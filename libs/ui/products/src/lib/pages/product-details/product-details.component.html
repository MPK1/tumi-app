<mat-progress-bar
  mode="indeterminate"
  *ngIf="(product$ | async) === null"
></mat-progress-bar>
<ng-container *ngIf="product$ | async as product">
  <div
    class="
      dark-button
      p-4
      bg-secondary-containerDark
      text-secondary-onContainerDark
    "
    fxLayout="column"
    fxLayoutGap="2rem"
  >
    <div fxLayout="row" class="mb-6">
      <a routerLink=".." mat-icon-button>
        <mat-icon svgIcon="icon-circled-chevron-left"></mat-icon
      ></a>
      <div fxFlex="grow"></div>
      <a routerLink="edit" mat-icon-button *tumiIfRole="[Role.Admin]">
        <mat-icon svgIcon="icon-edit"></mat-icon
      ></a>
    </div>
    <div>
      <img
        [src]="product.leadImage?.src"
        class="rounded-lg overflow-hidden w-64 mx-auto"
      />
    </div>
    <h1>{{ product.title }}</h1>
  </div>
  <div fxLayout="column" fxLayout.gt-md="row">
    <main class="p-4" fxFlex.gt-md="grow">
      <markdown
        [data]="product.description"
        class="prose lg:prose-lg"
      ></markdown>
      <div class="mt-6">
        <tumi-grid maxWidth="400px" minWidth="200px">
          <img
            *ngFor="let image of product.images"
            [src]="image.src"
            class="rounded-lg"
          />
        </tumi-grid>
      </div>
    </main>
    <aside fxFlex.gt-md="33" class="p-4">
      <tumi-order-product
        [product]="product"
        [user]="user$ | async"
      ></tumi-order-product>
    </aside>
  </div>
</ng-container>
